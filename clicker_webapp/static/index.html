<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö–ª–∏–∫–µ—Ä</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', Arial, sans-serif;
            background: linear-gradient(135deg, #232526 0%, #414345 100%);
            color: #fff;
            min-height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        h1 {
            margin-top: 32px;
            font-size: 2.5em;
            letter-spacing: 2px;
            text-shadow: 0 4px 24px #000a;
        }
        .score {
            font-size: 2.5em;
            margin: 30px 0 10px 0;
            font-weight: 700;
            text-shadow: 0 2px 12px #0008;
        }
        .main-btn {
            font-size: 2em;
            padding: 18px 60px;
            margin: 18px 0 30px 0;
            border: none;
            border-radius: 18px;
            background: linear-gradient(90deg, #43cea2 0%, #185a9d 100%);
            color: #fff;
            font-weight: 700;
            box-shadow: 0 6px 24px #185a9d55;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .main-btn:active {
            transform: scale(0.97);
            box-shadow: 0 2px 8px #185a9d33;
        }
        .upgrades {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 18px;
            margin-bottom: 18px;
        }
        .upgrade-card {
            background: linear-gradient(120deg, #232526 60%, #43cea2 100%);
            border-radius: 16px;
            box-shadow: 0 2px 16px #0005;
            padding: 18px 22px;
            min-width: 140px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: box-shadow 0.2s;
        }
        .upgrade-card:hover {
            box-shadow: 0 6px 32px #43cea299;
        }
        .upgrade-title {
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 6px;
        }
        .upgrade-count {
            font-size: 1.2em;
            margin-bottom: 8px;
        }
        .upgrade-btn {
            background: linear-gradient(90deg, #43cea2 0%, #185a9d 100%);
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 8px 22px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            margin-top: 4px;
            box-shadow: 0 2px 8px #185a9d33;
            transition: background 0.2s, transform 0.1s;
        }
        .upgrade-btn:active {
            background: linear-gradient(90deg, #185a9d 0%, #43cea2 100%);
            transform: scale(0.97);
        }
        .boost-bar {
            width: 90vw;
            max-width: 400px;
            height: 18px;
            background: #222b;
            border-radius: 10px;
            margin: 18px auto 0 auto;
            overflow: hidden;
            box-shadow: 0 2px 8px #43cea288;
        }
        .boost-bar-inner {
            height: 100%;
            background: linear-gradient(90deg, #f7971e 0%, #ffd200 100%);
            transition: width 0.5s;
        }
        .info {
            margin: 18px 0 0 0;
            font-size: 1.1em;
            color: #b2f7ef;
            text-shadow: 0 1px 4px #0008;
        }
        @media (max-width: 600px) {
            .score { font-size: 2em; }
            .main-btn { font-size: 1.2em; padding: 12px 20px; }
            .upgrade-card { min-width: 110px; padding: 12px 8px; }
        }
    </style>
</head>
<body>
    <h1>üïπÔ∏è –ö–ª–∏–∫–µ—Ä</h1>
    <div class="score" id="score">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <button class="main-btn" id="clickBtn">–ö–ª–∏–∫!</button>
    <div class="upgrades">
        <div class="upgrade-card">
            <div class="upgrade-title">–ê–≤—Ç–æ-–∫–ª–∏–∫</div>
            <div class="upgrade-count" id="autoClickCount">0</div>
            <button class="upgrade-btn" id="autoClickBtn">–ö—É–ø–∏—Ç—å (100)</button>
        </div>
        <div class="upgrade-card">
            <div class="upgrade-title">–ú–Ω–æ–∂–∏—Ç–µ–ª—å</div>
            <div class="upgrade-count" id="multiplierCount">0</div>
            <button class="upgrade-btn" id="multiplierBtn">–ö—É–ø–∏—Ç—å (200)</button>
        </div>
        <div class="upgrade-card">
            <div class="upgrade-title">–ë—É—Å—Ç</div>
            <div class="upgrade-count" id="boostCount">0</div>
            <button class="upgrade-btn" id="boostBtn">–ö—É–ø–∏—Ç—å (300)</button>
        </div>
    </div>
    <div class="boost-bar" id="boostBar" style="display:none;">
        <div class="boost-bar-inner" id="boostBarInner" style="width:0%"></div>
    </div>
    <div class="info" id="info"></div>
    <script>
        let user_id = null;
        if (window.Telegram && Telegram.WebApp && Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) {
            user_id = Telegram.WebApp.initDataUnsafe.user.id;
        } else {
            user_id = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à user_id (–¥–ª—è —Ç–µ—Å—Ç–∞):');
        }
        async function fetchStatus() {
            const res = await fetch(`/api/get?user_id=${user_id}`);
            const data = await res.json();
            document.getElementById('score').innerText = `–í–∞—à —Å—á–µ—Ç: ${data.score}`;
            document.getElementById('autoClickCount').innerText = data.upgrades?.auto_click || 0;
            document.getElementById('multiplierCount').innerText = data.upgrades?.multiplier || 0;
            document.getElementById('boostCount').innerText = data.upgrades?.boost || 0;
            let mult = 1 + (data.upgrades?.multiplier || 0);
            let info = `–ú–Ω–æ–∂–∏—Ç–µ–ª—å: x${mult}`;
            if (data.boost_until && data.boost_until > Date.now()/1000) {
                mult *= 3;
                let left = Math.floor(data.boost_until - Date.now()/1000);
                info += ` | –ë—É—Å—Ç –∞–∫—Ç–∏–≤–µ–Ω: x3 (${left} —Å–µ–∫.)`;
                document.getElementById('boostBar').style.display = '';
                let percent = Math.max(0, Math.min(100, 100 * left / 120));
                document.getElementById('boostBarInner').style.width = percent + '%';
            } else {
                document.getElementById('boostBar').style.display = 'none';
            }
            document.getElementById('info').innerHTML = info;
        }
        document.getElementById('clickBtn').onclick = async () => {
            await fetch(`/api/click?user_id=${user_id}`, {method: 'POST'});
            fetchStatus();
        };
        document.getElementById('autoClickBtn').onclick = async () => {
            await fetch(`/api/upgrade?user_id=${user_id}&type=auto_click`, {method: 'POST'});
            fetchStatus();
        };
        document.getElementById('multiplierBtn').onclick = async () => {
            await fetch(`/api/upgrade?user_id=${user_id}&type=multiplier`, {method: 'POST'});
            fetchStatus();
        };
        document.getElementById('boostBtn').onclick = async () => {
            await fetch(`/api/upgrade?user_id=${user_id}&type=boost`, {method: 'POST'});
            fetchStatus();
        };
        fetchStatus();
        setInterval(fetchStatus, 2000);
    </script>
</body>
</html> 